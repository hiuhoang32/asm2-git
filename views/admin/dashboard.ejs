<!DOCTYPE html>
<html>
<head>
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
</head>
<body>
    <div class="container">
        <h1>Admin Dashboard</h1>
        <a href="/admin/add-tour" class="btn btn-primary">Add New Tour</a>
        <a href="/admin/logout" class="btn btn-danger">Logout</a>
        <h2>Existing Tours</h2>
        <ul>
            <% tours.forEach(tour => { %>
                <li>
                    <h3>ID: <%= tour._id %></h3>
                    <p><strong>Title:</strong> <%= tour.title %></p>
                    <p><strong>Location:</strong> <%= tour.location %></p>
                    <p><strong>Duration:</strong> <%= tour.duration %></p>
                    <p><strong>Recommended People Count:</strong> <%= tour.recommendedPeopleCount %></p>
                    <p><strong>Base Price:</strong> $<%= tour.basePrice %></p>
                    <p><strong>Description:</strong> <%= tour.about %></p>
                    <p><strong>Included:</strong> <%= tour.included.join(', ') %></p>
                    <p><strong>Excluded:</strong> <%= tour.excluded.join(', ') %></p>
                    <h4>Tour Plan:</h4>
                    <ul>
                        <% tour.plan.forEach(day => { %>
                            <li>
                                <strong><%= day.dayTitle %></strong>: <%= day.dayDescription %>
                            </li>
                        <% }) %>
                    </ul>
                    <h4>Images:</h4>
                    <ul>
                        <% tour.images.forEach(image => { %>
                            <li><img src="<%= image %>" alt="Tour Image" style="width: 200px;"></li>
                        <% }) %>
                    </ul>
                    <button class="btn btn-danger delete-tour" data-id="<%= tour._id %>">Delete Tour</button>
                </li>
            <% }) %>
        </ul>
    </div>
    <script>
        document.querySelectorAll('.delete-tour').forEach(button => {
            button.addEventListener('click', async (e) => {
                const tourId = e.target.getAttribute('data-id');
                if (confirm('Are you sure you want to delete this tour?')) {
                    try {
                        const response = await fetch(`/admin/deleteTour/${tourId}`, {
                            method: 'DELETE',
                            headers: {
                                'Content-Type': 'application/json'
                            }

                        });
                        const data = await response.json();
                        if (response.ok) {
                            alert(data.message);
                            window.location.reload();
                        } else {
                            alert(data.message);
                        }
                    } catch (error) {
                        alert('Error deleting tour');
                    }
                }
            });
        });
    </script>
</body>
</html>
